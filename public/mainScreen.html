<!--
==== =================================================================

==    MAINSCREEN.HTML    ==
==    Dit bestand word ingeladen in de container in de index.html als het hoofdscherm.
==    In MAINSCREEN voeren we de broadcasts uit en andere verschillende functies,
==    daarom is dit te vergelijken met de daadwerkelijke 'homepage'.

==== =================================================================
==    Door Thijs Boerma, th.boerma@gmail.com | 2017                 ==
==== =================================================================
-->

<!-- bovenste helft ----------------------------------------------------------->
<div class="middle row">

  <!-- linkerbar -->
  <div class="left-bar col-xs-12 col-sm-12 col-md-4 col-lg-3">

    <div id="notificationTitleSmall" class="headerblock">
      <h2>Waiting for broadcasts ...</h2>
    </div>

    <div class="block block-light col-xs-12">
      <h1 id="clock">[ 00:00:00 ECT ]</h1>
    </div>

    <div class="block block-medium col-xs-12">
      <p>Last notification:</p>
      <p><span id="lastBroadcastTitle">N/A</span>&nbsp;&nbsp;|&nbsp;&nbsp;<span id="lastBroadcastTime">00:00</span></p>
    </div>

  </div>



  <!-- centraal blok -->
  <div class="middle-bar col-xs-11 col-sm-11 col-md-7 col-lg-8">
    <div class="block">
      <div id="notificationContainer"></div>
    </div>
  </div>



  <!-- rechter minibar -->
  <div class="right-bar col-xs-1 col-sm-1 col-md-1 col-lg-1">

  </div>
</div>

<!-- onderste helft ----------------------------------------------------------->
<div class="footer row">

  <div class="item col-xs-12 col-sm-12 col-md-4 col-lg-2">
    <div id="firstFooterBlock" class="block">
      <div class="content">
        <h1 id="dd">01</h1>
        <h1 id="dow">FRIDAY</h1>
        <h3>MARCH 240NT</h3>
      </div>
    </div>
  </div>

  <div class="item col-xs-12 col-sm-12 col-md-4 col-lg-2">
    <div class="block">
      <div class="content">
        <h1>ALERT LEVEL</h1>
        <h3>-</h3>
      </div>
    </div>
  </div>

  <div class="item col-xs-12 col-sm-12 col-md-4 col-lg-2">
    <div class="block">&nbsp;</div>
  </div>

  <div class="item col-xs-12 col-sm-12 col-md-9 col-lg-5">
    <div class="block">&nbsp;</div>
  </div>

  <div class="item col-xs-12 col-sm-12 col-md-3 col-lg-1">
    <div class="block bottom-right">
      <img src="/images/fourpoint.png">
    </div>
  </div>

</div>

<script>
$(document).ready(function(){
  updateFooter();

  // var broadcastTest = ["Broadcasting Test","testBroadcast","0","0","0"];
  var broadcastTest = {
    title:"Broadcast Test",
    file:"testBroadcast",
    priority:"1",
    duration:"0",
    colorscheme:"0"
  };

  setTimeout(function(){
    console.log('broadcastSend');
    socket.emit('broadcastSend', broadcastTest);
  },500);

  socket.on('broadcastReceive', function(location){

    /* maakt een timestamp zoals bij de clock update, maar korter. */
    var currentTime = new Date();
    var currentHours   = currentTime.getHours ( );
    var currentMinutes = currentTime.getMinutes ( );
    currentMinutes = ( currentMinutes < 10 ? "0" : "" ) + currentMinutes;
    currentHours = ( currentHours == 0 ) ? 12 : currentHours;
    var currentTimeString = currentHours + ":" + currentMinutes + ":" + "&nbsp;ECT";

    /* update 'Last broadcast' */

    // $("#lastBroadcastTitle").html(location[0]);
    // $("#lastBroadcastTime").html(currentTimeString);
    //
    // console.log('broadcastReceive');
    // console.log(location);
    // $('#notificationContainer').load('/broadcasts/'+location[1]+'.html');

    $("#lastBroadcastTitle").html(location['title']);
    $("#lastBroadcastTime").html(currentTimeString);

    console.log('broadcastReceive');
    console.log(location);
    $('#notificationContainer').load('/broadcasts/'+location['file']+'.html');
  });

});
</script>
